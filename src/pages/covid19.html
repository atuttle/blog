<!DOCTYPE html>
<html>
	<head>
		<title>COVID19 - New Infections by Day in Chester County, PA</title>
		<script>
			window.onload = function() {
				var dataPoints = [];

				var chart = new CanvasJS.Chart('chartContainer', {
					animationEnabled: true,
					theme: 'dark2',
					title: {
						text: 'COVID19 Daily Infection Delta (Chester County, PA)'
					},
					axisY: {
						title: 'New Confirmed Infections',
						titleFontSize: 24
					},
					data: [
						{
							type: 'column',
							yValueFormatString: '#,### new confirmed infections',
							dataPoints: dataPoints
						}
					]
				});

				function addData(data) {
					console.log(data);
					for (var i = 0; i < data.features.length; i++) {
						dataPoints.push({
							x: new Date(data.features[i].attributes.Date),
							y: data.features[i].attributes.Positives_Daily
						});
					}
					chart.render();
				}

				$.getJSON(
					'https://services.arcgis.com/G4S1dGvn7PIgYd6Y/arcgis/rest/services/COVID_19_Cases_Chester_County__PA/FeatureServer/2/query?f=json&where=1%3D1&returnGeometry=false&spatialRel=esriSpatialRelIntersects&outFields=*&orderByFields=Date%20asc&outSR=102100&resultOffset=0&resultRecordCount=32000&resultType=standard&cacheHint=true',
					addData
				);
			};
		</script>
	</head>
	<body>
		<div
			id="chartContainer"
			style="height: 100%; min-height: 600px; width: 100%;"
		></div>
		<div style="margin-top: 20px;">
			Data source:
			<a
				href="https://chesco.maps.arcgis.com/apps/opsdashboard/index.html#/975082d579454c3ca7877db0a44e61ca"
				>https://chesco.maps.arcgis.com/apps/opsdashboard/index.html#/975082d579454c3ca7877db0a44e61ca</a
			>
		</div>
		<script src="https://canvasjs.com/assets/script/jquery-1.11.1.min.js"></script>
		<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
	</body>
</html>
